plugins {
    id 'java-library'
    id 'application'
}

group 'se.billy'
version '1.0-SNAPSHOT'

ext.moduleName = 'musicserver'
mainClassName = 'musicserver/se.billy.Main'

repositories {
    jcenter()
}

dependencies {
    compile 'com.sparkjava:spark-core:2.7.2'
    compile 'com.fasterxml.jackson.core:jackson-databind:2.9.6'

    testCompile group: 'junit', name: 'junit', version: '4.12'
}

run {
    inputs.property("moduleName", moduleName)
    doFirst {
        jvmArgs = [
                '--module-path', classpath.asPath,
                '--module', mainClassName
        ]
        classpath = files()
    }
}

startScripts {
    inputs.property("moduleName", moduleName)
    doFirst {
        classpath = files()
        defaultJvmOpts = [
                '--module-path', 'APP_HOME_LIBS',
                '--module', mainClassName
        ]
    }
}


afterEvaluate {
    compileJava {
        inputs.property("moduleName", moduleName)
        doFirst {
            options.compilerArgs = [
                    '--module-path', classpath.asPath,
            ]
            classpath = files()
        }
    }
}
